<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100..900&family=Sono:wght@200..800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="../css/manage.css">
    <title>Management</title>
</head>

<body>
    <nav class="navigation">
        <div class="logo">
            <a href=""><img src="../system/newlogo.png" alt="Stride Sync"></a>
        </div>
        <div class="item">
            <div class="route">
                <ul>
                    <a href="/dashboard">
                        <li><ion-icon name="speedometer-outline"></ion-icon>
                            <p>Dashboard</p>
                        </li>
                    </a>
                    <a href="/manage">
                        <li id="here"><ion-icon name="grid-outline"></ion-icon>
                            <p>Management</p>
                        </li>
                    </a>
                    <a href="">
                        <li><ion-icon name="pie-chart-outline"></ion-icon>
                            <p>Statistical
                        </li>
                    </a>
                    <a href="">
                        <li><ion-icon name="help-circle-outline"></ion-icon>
                            <p>About Us</p>
                        </li>
                    </a>
                </ul>
            </div>
            <div class="account">
                <h4>ACCOUNT</h4>
                <ul>
                    <a href="">
                        <li><ion-icon name="person-outline"></ion-icon>
                            <p>My Info</p>
                        </li>
                    </a>
                    <a href="">
                        <li><ion-icon name="cart-outline"></ion-icon>
                            <p>My Orders</p>
                        </li>
                    </a>
                    <a href="">
                        <li><ion-icon name="settings-outline"></ion-icon>
                            <p>Setting</p>
                        </li>
                    </a>
                </ul>
            </div>
            <div id="helpCenter" class="help-center">
                <span><ion-icon name="mail-outline"></ion-icon></span>
                <h3>Contact Us</h3>
                <p>Having trouble in StrideSync. Please contact us for more questions.</p>
                <button class="btn-help">Go to contact</button>
                <span id="glass"></span>
            </div>
        </div>
    </nav>
    <section>
        <header>
            <div class="welcome-box">
                <h1>Management</h1>
            </div>
            <div class="user-box">
                <span class="notification"><ion-icon name="bag-outline"></ion-icon></span>
                <span class="user-avt">
                    <img id="user-avatar" src="../avt.png" alt="">
                </span>
            </div>
        </header>
        <div class="container">
            <div class="search">
                <h1>Search Product</h1>
                <div class="main-search">
                    <label>Enter the information you want search</label><br>
                    <input type="text" name="info-Search" id="infoSearch" placeholder="Enter id or name of product">
                </div>
                <div class="more-search">
                    <label for="price">Price you want search</label><br>
                    <input type="number" name="price" id="minPrice" min="0" placeholder="from">
                    <input type="number" name="price" id="maxPrice" min="0" placeholder="to"><br>

                    <label for="size">Size you want search</label><br>
                    <input type="number" name="size" id="sizeSearch" min="0" placeholder="Enter size"><br>

                    <label for="quantity">Quantity Price you want search</label><br>
                    <input type="number" name="quantity" id="quantity" min="0" placeholder="Enter quantity "><br>
                </div>
                <div class="ativated-point">
                    <div class="animation">
                        <button onclick="searchProduct()">Search</button>
                    </div>
                    <span class="extend-search" onclick="extendSearch()"><i
                            class="fa-solid fa-angles-right fa-rotate-90" style="color: #000000;"></i></span>
                </div>
            </div>
            <div class="update">
                <h1>Update</h1>
                <form>
                    <label for="name">Name Product</label><br>
                    <input type="text" name="name" id="nameUpdate" placeholder="Enter name you want update"><br>
                    <label for="price">Price</label><br>
                    <input type="number" name="price" id="priceUpdate" min="0" placeholder="Enter price you want update"><br>
                    <label for="size-and-quantity">Size and Quantity</label><br>
                    <input type="number" name="size" id="sizeUpdate" min="0" placeholder="size">
                    <input type="number" name="quantity" id="quantityUpdate" min="0" placeholder="Enter quantity for size" disabled><br>
                    <label for="uploadImage">Upload Image</label><br>
                    <input type="file" name="uploadFile" id="uploadFile"><br>
                </form>
                <div class="animation">
                    <button onclick="updateProduct()">Update</button>
                </div>
            </div>
        </div>
        <div class="containerProduct">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Price</th>
                            <th>Size-Quantity</th>
                            <th>Image Product</th>
                            <th>Func</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="shoe in list">
                            <td>{{shoe._id}}</td>
                            <td>Áo thun nam</td>
                            <td>150.000đ</td>
                            <td>
                                <p>35-60</p>
                                <p>46-80</p>
                            </td>
                            <td><img src="" alt=""></td>
                            <td>
                                <button id="delete" style="background: red;"onclick="confirmDelete()">Delete</button>
                                <button id="showFormUpdate" style="background: yellow;" onclick="showFormUpdate()">Update</button>
                            </td>
                        </tr>
                        
                    </tbody>
                </table>
        </div>
    </section>
    <footer>

    </footer>

    <script src="../javascript/manage.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        function updateProduct() {
            const name = document.getElementById('nameUpdate').value;
            const price = document.getElementById('priceUpdate').value;
            const size = document.getElementById('sizeUpdate').value;
            const quantity = document.getElementById('quantityUpdate').value;
            const updateForm = document.getElementById('updateForm');
            
            const productData = {
                shoes: {
                    // Các thuộc tính của sản phẩm cần được gửi đến server
                    name,
                    price,
                    size,
                    quantity
                },
                updateFields: {
                    // Các trường cần được cập nhật trên sản phẩm
                    name: name,
                    price: price,
                    size: size,
                    quantity: quantity
                }
            };
    
            fetch('/api/updateShoes', { // Thay đổi URL tại đây
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(productData)
            })
            .then(response => response.json())
            .then(data=> {                
                alert(data.message);
            })
            .catch
            {
                console.log(Error);
            }
        }

        function confirmDelete() {
        // Xác nhận xóa sản phẩm
        const infoSearch= document.getElementById('infoSearch').value;
        const confirmDelete = confirm("Are you sure you want to delete this product?");
        if(confirmDelete)
            {
                deleteProduct(infoSearch);
            }else {
                console.log(`Delete cancelled.`)
            }
        }
        // Gửi yêu cầu DELETE đến API
        function deleteProduct(productId){
        fetch(`/api/delete/${productId}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            // Xử lý kết quả từ server
            alert(data.message);
            // Reload trang hoặc cập nhật giao diện sau khi xóa sản phẩm thành công
            location.reload();
        })
        .catch(error => {
            console.log(Error);
            alert('An error occurred while deleting the product.');
        });
    }
    </script>
    
</body>

</html>